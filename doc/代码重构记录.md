为什么要去做架构优化
当前项目已经连续迭代快两年了，中间没有大的优化，因为项目的发展方向是快速变化的，所以初期的架构已经严重制约了当前项目的继续迭代开发，目前下单模块继续增加功能已经举步维艰，任意一个地方的修改，可能会导致连锁反应，给项目带来了极大的风险，而且这个项目的包已经快接近微信对小程序的包最大限制，当前项目已经和中心的核心项目，后面肯定还会继续开发下去，所以很有必要对项目代码进行一次重构，为后面的功能增加创造空间。

限制条件
作为用户超过两亿的产品，任何修改都必须要兼容老的功能，代码结构是不能随便动的，因为有很多推送消息很分享，打开路径都是写死的，如果动了不该动的代码结构，可能之前推送的消息打开的页面就是一个不存在的页面，则面临这一段时间新旧版本簿兼容的问题，甚至还要去推动后端改一些东西，这个是不可接受的。

目标
去掉已经下线的功能代码及资源文件
去掉已经不再使用的灰度，减少不必要的请求
将代码抽离到其他文件，避免主文件糅合太多代码，尤其是下单模块，一个文件的代码已经接近5000行
将逻辑梳理一遍，使代码逻辑能够更清晰，对于可以抽取公共代码的予以抽取，对于不必要的耦合，可以进行拆分，不必过分追求代码的复用

步骤
和产品确认，哪些功能可以下线，确认完后，可以将对应的功能代码删掉

和产品确认哪些灰度已经开放全网，不需要再调用灰度接口，可以将这些调用灰度的代码去掉

划分模块，将代码拆到各个模块，降低耦合

对各个模块进行优化



